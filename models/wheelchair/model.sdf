<?xml version="1.0" ?>
<sdf version="1.5">
  <model name="wheelchair">  
  <pose>0.0 0.0 0.0 0.0 0.0 0.0</pose>

    <link name="base_footprint"/>

    <link name="base_link">

      <inertial>
          <pose>0.000602 0 0.476823 0 -0 0</pose>
          <mass>70.435</mass>
          <inertia>
            <ixx>3.02781</ixx>
            <ixy>0</ixy>
            <ixz>-0.012125</ixz>
            <iyy>3.43197</iyy>
            <iyz>0</iyz>
            <izz>0.968001</izz>
          </inertia>
        </inertial>

      <collision name="base_collision">
        <pose>-0.4 0 0.01 -0.1 -0.0 1.57</pose>
        <geometry>
          <mesh>
            <uri>model://wheelchair/meshes/Wheelchair.stl</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh>
        </geometry>
      </collision>

      <visual name="base_visual">
        <pose>-0.4 0 0.01 -0.1 -0.0 1.57</pose>
          <geometry>
          <mesh>
            <uri>model://wheelchair/meshes/Wheelchair.stl</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh>
        </geometry>
          <material>
            <ambient>0.8392 0.6314 0 1</ambient>
            <diffuse>0.8392 0.6314 0 1</diffuse>
            <specular>0.99 0.99 0.99 1</specular>
            <emissive>0 0 0 0</emissive>
          </material>
        </visual>
    </link>

    <!-- Joints  -->


    <joint name="base_joint" type="fixed">
      <parent>base_footprint</parent>
      <child>base_link</child>
      <pose>0.0 0.0 0.010 0 0 0</pose>
    </joint>



<!-- Wheels -->
          <joint name='front_left_wheel_joint' type='revolute'>
        <pose relative_to='base_link'>0.19 0.25 0.076 0 -0 0</pose>
        <parent>base_link</parent>
        <child>front_left_wheel_link</child>
        <axis>
          <xyz>0 1 0</xyz>
          <limit>
              <lower>-1e+16</lower>
              <upper>1e+16</upper>
            </limit>
            <dynamics>
              <damping>0.0</damping> <!-- Minimal resistance for free rolling -->
            </dynamics>
          <dynamics>
            <spring_reference>0</spring_reference>
            <spring_stiffness>0</spring_stiffness>
          </dynamics>
        </axis>
      </joint>

      <joint name="front_left_wheel_swivel_joint" type="revolute">
        <parent>base_link</parent>
        <child>front_left_wheel_swivel_link</child>
        <axis>
          <xyz>0 0 1</xyz> <!-- Vertical axis for swivel -->
          <limit>
            <lower>-1e+16</lower>
            <upper>1e+16</upper>
          </limit>
          <dynamics>
            <damping>1.0</damping> <!-- Minimal resistance for free rolling -->
          </dynamics>

        </axis>
      </joint>
      
      <link name='front_left_wheel_link'>
        <pose relative_to='front_left_wheel_joint'>0 0 0 0 -0 0</pose>
        <inertial>
          <pose>0 0 0 0 -0 0</pose>
          <mass>0.6</mass>
          <inertia>
            <ixx>0.00138624</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.00138624</iyy>
            <iyz>0</iyz>
            <izz>0.00138624</izz>
          </inertia>
        </inertial>
        <collision name='front_left_wheel_link_collision'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.076</radius>
            </cylinder>
          </geometry>
          <surface>
            <contact>
              <ode/>
            </contact>
            <friction>
              <ode>
                <mu>0.01</mu>
                <mu2>0.01</mu2>
              </ode>
              <torsional>
                <ode/>
              </torsional>
            </friction>
            <bounce/>
          </surface>
          <max_contacts>10</max_contacts>
        </collision>
        <visual name='front_left_wheel_link_visual'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.076</radius>
            </cylinder>
          </geometry>
          <material>
            <ambient>0.1764 0.4588 0.8509 1</ambient>
            <diffuse>0.1764 0.4588 0.8509 1</diffuse>
            <specular>0.1764 0.4588 0.8509 1</specular>
            <emissive>0 0 0 0</emissive>
          </material>
        </visual>
        <self_collide>0</self_collide>
        <enable_wind>0</enable_wind>
        <kinematic>0</kinematic>
      </link>

      <!-- Swivel link for front left wheel -->
      <link name="front_left_wheel_swivel_link">
          <pose>0.15 0.28 0.076 0 -0 0</pose>
          <visual name="front_left_wheel_swivel_visual">
              <geometry>
                  <cylinder>
                      <radius>0.01</radius> <!-- Small cylinder for visualization -->
                      <length>0.05</length>
                  </cylinder>
              </geometry>
              <material>
                  <ambient>0 0 1 1</ambient> <!-- Blue for visibility -->
                  <diffuse>0 0 1 1</diffuse>
                  <specular>0.99 0.99 0.99 1</specular>
              </material>
          </visual>
      </link>


      <joint name='front_right_wheel_joint' type='revolute'>
        <pose relative_to='base_link'>0.19 -0.24 0.076 0 -0 0</pose>
        <parent>base_link</parent>
        <child>front_right_wheel_link</child>
        <axis>
          <xyz>0 1 0</xyz>
          <limit>
            <lower>-1e+16</lower>
            <upper>1e+16</upper>
          </limit>
          <dynamics>
            <damping>1.0</damping> <!-- Minimal resistance for free rolling -->
          </dynamics>
          <dynamics>
            <spring_reference>0</spring_reference>
            <spring_stiffness>0</spring_stiffness>
          </dynamics>
        </axis>
      </joint>

      <joint name='front_right_wheel_swivel_joint' type='revolute'>
        <pose relative_to='base_link'>0.15 -0.21 0.076 0 -0 0</pose>
        <parent>base_link</parent>
        <child>front_right_wheel_swivel_link</child>
        <axis>
          <xyz>0 0 1</xyz>
          <limit>
            <lower>-1e+16</lower>
            <upper>1e+16</upper>
          </limit>
          <dynamics>
            <damping>0.0</damping> <!-- Minimal resistance for free rolling -->
          </dynamics>
          <dynamics>
            <spring_reference>0</spring_reference>
            <spring_stiffness>0</spring_stiffness>
          </dynamics>
        </axis>
      </joint>


      <link name='front_right_wheel_link'>
        <pose relative_to='front_right_wheel_joint'>0 0 0 0 -0 0</pose>
        <inertial>
          <pose>0 0 0 0 -0 0</pose>
          <mass>0.6</mass>
          <inertia>
            <ixx>0.00138624</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.00138624</iyy>
            <iyz>0</iyz>
            <izz>0.00138624</izz>
          </inertia>
        </inertial>
        <collision name='front_right_wheel_link_collision'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.076</radius>
            </cylinder>
          </geometry>
          <surface>
            <contact>
              <ode/>
            </contact>
            <friction>
              <ode>
                <mu>0.01</mu>
                <mu2>0.01</mu2>
              </ode>
              <torsional>
                <ode/>
              </torsional>
            </friction>
            <bounce/>
          </surface>
          <max_contacts>10</max_contacts>
        </collision>
        <visual name='front_right_wheel_link_visual'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.076</radius>
            </cylinder>
          </geometry>
          <material>
            <ambient>0.1764 0.4588 0.8509 1</ambient>
            <diffuse>0.1764 0.4588 0.8509 1</diffuse>
            <specular>0.1764 0.4588 0.8509 1</specular>
            <emissive>0 0 0 0</emissive>
          </material>
        </visual>
        <self_collide>0</self_collide>
        <enable_wind>0</enable_wind>
        <kinematic>0</kinematic>
      </link>

      <link name="front_right_wheel_swivel_link">
        <pose>0.15 -0.21 0.076 0 -0 0</pose>
        <visual name="front_right_wheel_swivel_visual">
            <geometry>
                <cylinder>
                    <radius>0.01</radius>
                    <length>0.05</length>
                </cylinder>
            </geometry>
            <material>
                <ambient>0 0 1 1</ambient> <!-- Blue for visibility -->
                <diffuse>0 0 1 1</diffuse>
                <specular>0.99 0.99 0.99 1</specular>
            </material>
        </visual>
    </link>


      <joint name='rear_left_wheel_joint' type='revolute'>
        <pose relative_to='base_link'>-0.19 0.26 0.27 0 -0 0</pose>
        <parent>base_link</parent>
        <child>rear_left_wheel_link</child>
        <axis>
          <xyz>0 1 0</xyz>
          <limit>
            <lower>-1e+16</lower>
            <upper>1e+16</upper>
          </limit>
          <dynamics>
            <damping>2.0</damping> 
            <spring_reference>0</spring_reference>
            <spring_stiffness>0</spring_stiffness>
          </dynamics>
        </axis>
      </joint>
      <link name='rear_left_wheel_link'>
        <pose relative_to='rear_left_wheel_joint'>0 0 0 0 -0 0</pose>
        <inertial>
          <pose>0 0 0 0 -0 0</pose>
          <mass>0.6</mass>
          <inertia>
            <ixx>0.00138624</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.00138624</iyy>
            <iyz>0</iyz>
            <izz>0.00138624</izz>
          </inertia>
        </inertial>
        <collision name='rear_left_wheel_link_collision'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.27</radius>
            </cylinder>
          </geometry>
          <surface>
            <contact>
              <ode/>
            </contact>
            <friction>
              <ode>
                <mu>1.5</mu>
                <mu2>1.5</mu2>
              </ode>
              <torsional>
                <ode/>
              </torsional>
            </friction>
            <bounce/>
          </surface>
          <max_contacts>10</max_contacts>
        </collision>
        <visual name='rear_left_wheel_link_visual'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.27</radius>
            </cylinder>
          </geometry>
          <material>
            <ambient>0.1764 0.4588 0.8509 1</ambient>
            <diffuse>0.1764 0.4588 0.8509 1</diffuse>
            <specular>0.1764 0.4588 0.8509 1</specular>
            <emissive>0 0 0 0</emissive>
          </material>
        </visual>
        <self_collide>0</self_collide>
        <enable_wind>0</enable_wind>
        <kinematic>0</kinematic>
      </link>
      <joint name='rear_right_wheel_joint' type='revolute'>
        <pose relative_to='base_link'>-0.19 -0.25 0.27 0 -0 0</pose>
        <parent>base_link</parent>
        <child>rear_right_wheel_link</child>
        <axis>
          <xyz>0 1 0</xyz>
          <limit>
            <lower>-1e+16</lower>
            <upper>1e+16</upper>
          </limit>
          <dynamics>
            <damping>2.0</damping> 
            <spring_reference>0</spring_reference>
            <spring_stiffness>0</spring_stiffness>
          </dynamics>
        </axis>
      </joint>
      <link name='rear_right_wheel_link'>
        <pose relative_to='rear_right_wheel_joint'>0 0 0 0 -0 0</pose>
        <inertial>
          <pose>0 0 0 0 -0 0</pose>
          <mass>0.6</mass>
          <inertia>
            <ixx>0.00138624</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.00138624</iyy>
            <iyz>0</iyz>
            <izz>0.00138624</izz>
          </inertia>
        </inertial>
        <collision name='rear_right_wheel_link_collision'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.27</radius>
            </cylinder>
          </geometry>
          <surface>
            <contact>
              <ode/>
            </contact>
            <friction>
              <ode>
                <mu>1.5</mu>
                <mu2>1.5</mu2>
              </ode>
              <torsional>
                <ode/>
              </torsional>
            </friction>
            <bounce/>
          </surface>
          <max_contacts>10</max_contacts>
        </collision>
        <visual name='rear_right_wheel_link_visual'>
          <pose>0 0 0 1.5708 -0 0</pose>
          <geometry>
            <cylinder>
              <length>0.026</length>
              <radius>0.27</radius>
            </cylinder>
          </geometry>
          <material>
            <ambient>0.1764 0.4588 0.8509 1</ambient>
            <diffuse>0.1764 0.4588 0.8509 1</diffuse>
            <specular>0.1764 0.4588 0.8509 1</specular>
            <emissive>0 0 0 0</emissive>
          </material>
        </visual>
        <self_collide>0</self_collide>
        <enable_wind>0</enable_wind>
        <kinematic>0</kinematic>
      </link>

      <!-- Aruco marker front -->
      <joint name="aruco_marker_front_joint" type="fixed">
      <parent>base_link</parent>
      <child>aruco_marker_front_link</child>
      <pose relative_to="base_link">-0.24 0.17 0.27 0 0 0</pose>
    </joint>
    <link name="aruco_marker_front_link">
    <pose relative_to="aruco_marker_front_joint">0.0 0.0 0.0 0 0 0</pose>
      <visual name="aruco_marker_front_visual">
        <geometry>
          <mesh>
            <uri>model://wheelchair/meshes/Marker20.dae</uri>
          <scale>0.1 0.1 0.1 </scale></mesh>
        </geometry>
      </visual>
    </link>

      <!-- Aruco marker left -->
      <joint name="aruco_marker_left_joint" type="fixed">
      <parent>base_link</parent>
      <child>aruco_marker_left_link</child>
      <pose relative_to="base_link">-0.271 0.205 0.27 0 0 1.57</pose>
    </joint>
    <link name="aruco_marker_left_link">
    <pose relative_to="aruco_marker_left_joint">0.0 0.0 0.0 0 0 0</pose>
      <visual name="aruco_marker_left_visual">
        <geometry>
          <mesh>
            <uri>model://wheelchair/meshes/Marker21.dae</uri>
          <scale>0.1 0.1 0.1 </scale></mesh>
        </geometry>
      </visual>
    </link>

      <!-- Aruco marker right -->
      <joint name="aruco_marker_right_joint" type="fixed">
      <parent>base_link</parent>
      <child>aruco_marker_right_link</child>
      <pose relative_to="base_link">-0.271 -0.205 0.27 0 0 -1.57</pose>
    </joint>
    <link name="aruco_marker_right_link">
    <pose relative_to="aruco_marker_right_joint">0.0 0.0 0.0 0 0 0</pose>
      <visual name="aruco_marker_right_visual">
        <geometry>
          <mesh>
            <uri>model://wheelchair/meshes/Marker22.dae</uri>
          <scale>0.1 0.1 0.1 </scale></mesh>
        </geometry>
      </visual>
    </link>

    <!-- <plugin name='differential_drive' filename='libgazebo_ros_diff_drive.so'>

      <ros>

      </ros>

      <update_rate>30</update_rate>

      <left_joint>rear_left_wheel_joint</left_joint>
      <right_joint>rear_right_wheel_joint</right_joint>

      <wheel_separation>0.49</wheel_separation>
      <wheel_diameter>0.54</wheel_diameter>


      <max_wheel_torque>5</max_wheel_torque>
      <max_wheel_acceleration>1.0</max_wheel_acceleration>

      <command_topic>cmd_vel</command_topic>

      <publish_odom>true</publish_odom>
      <publish_odom_tf>true</publish_odom_tf>
      <publish_wheel_tf>false</publish_wheel_tf>

      <odometry_topic>odom</odometry_topic>
      <odometry_frame>odom</odometry_frame>
      <robot_base_frame>base_footprint</robot_base_frame>

    </plugin> -->

    <plugin name="wheelchair_joint_state" filename="libgazebo_ros_joint_state_publisher.so">
      <ros>
        <!-- <namespace>/tb3</namespace> -->
        <remapping>~/out:=joint_states</remapping>
      </ros>
      <update_rate>30</update_rate>
      <joint_name>base_joint</joint_name>
      <joint_name>front_left_wheel_joint</joint_name>
      <joint_name>front_left_wheel_swivel_joint</joint_name>
      <joint_name>front_right_wheel_joint</joint_name>
      <joint_name>front_right_wheel_swivel_joint</joint_name>
      <joint_name>rear_left_wheel_joint</joint_name>
      <joint_name>rear_right_wheel_joint</joint_name>

    </plugin>    

  </model>
</sdf>
