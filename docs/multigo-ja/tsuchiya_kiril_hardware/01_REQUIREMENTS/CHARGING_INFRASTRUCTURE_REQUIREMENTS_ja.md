# 充電インフラストラクチャ要件

**プロジェクト:** 屋外車椅子輸送ロボット - マルチチームシステム
**ドキュメントタイプ:** ハードウェア要件仕様
**チーム責任:** Tsuchiya（ハードウェア）+ Pankaj（自動充電ソフトウェア）
**ステータス:** 第5週 - アクティブ開発
**日付:** 2025年12月16日
**バージョン:** 1.0

---

## ドキュメント管理

| バージョン | 日付 | 作成者 | 変更内容 |
|---------|------|--------|---------|
| 1.0 | 2025-12-16 | マルチチーム | 初版充電インフラストラクチャ要件 |

**関連ドキュメント:**
- ELECTRICAL_REQUIREMENTS.md（48Vバッテリー、BMS、電力分配）
- NAVIGATION_REQUIREMENTS.md（充電ステーションへの自動復帰）
- DOCKING_SYSTEM_REQUIREMENTS.md（充電接点の精密ドッキング）
- FLEET_MANAGEMENT_REQUIREMENTS.md（充電スケジュール最適化）

---

## 1. 目的と範囲

本ドキュメントは、車椅子輸送ロボットフリートの**充電インフラストラクチャ**の要件を規定します：
- **充電ステーションハードウェア**（ドッキング接点、電力供給）
- **自動充電ワークフロー**（自動復帰、ドッキング、充電、出発）
- **充電中のバッテリー管理**（充電プロファイル、セルバランシング）
- **フリート充電調整**（キュー管理、優先度）
- **安全システム**（過電流保護、温度監視）

**設計目標:**
- 完全自動充電（手動介入なし）
- 充電ステーションあたり2-4台の車両をサポート
- 充電時間: 2時間（20% → 80% SOC）
- 耐候性屋外充電（IP54+）

---

## 2. 充電ステーションハードウェア要件

### 2.1 物理設計

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-HW-001 | 充電ステーションは最低2台の車両を同時に充電できる必要がある | 高 | 2ベイが機能的 |
| CHARGE-HW-002 | 各充電ベイの設置面積は2000mm × 1500mm（車両 + クリアランス）である必要がある | 高 | 寸法を検証 |
| CHARGE-HW-003 | 充電ステーションは耐候性である必要がある（IP54評価最低） | クリティカル | IP54認証取得 |
| CHARGE-HW-004 | 充電ステーションは充電中の車両を保護するための屋根を持つ必要がある | 中 | 屋根を設置 |
| CHARGE-HW-005 | ステーション床面は水平である必要がある（傾斜<2°）安定した車両ドッキングのため | クリティカル | 床面水平度を測定 |

### 2.2 電源

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-PWR-001 | 充電ステーションは200V 3相AC電源に接続される必要がある | クリティカル | 3相接続を検証 |
| CHARGE-PWR-002 | ステーションはベイごとに48V DC出力を提供する必要がある（車両あたり最大20A） | クリティカル | 48V @ 20A出力を測定 |
| CHARGE-PWR-003 | ステーションの総電力容量はベイあたり≥2kWである必要がある（2ベイ = 最低4kW） | クリティカル | 電力容量を検証 |
| CHARGE-PWR-004 | ステーションはAC-DCコンバーターを含む必要がある（200V AC → 48V DC、95%効率） | 高 | 効率を測定 |
| CHARGE-PWR-005 | ステーションは力率改善を持つ必要がある（PF >0.95） | 中 | 力率を測定 |
| CHARGE-PWR-006 | ステーションはベイ間の負荷分散をサポートする必要がある（利用可能な電力を分配） | 中 | 負荷分散が機能的 |

### 2.3 充電接点

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-CONTACT-001 | 充電接点はスプリング式ポゴピンを使用する必要がある（金メッキ、ピンあたり10A定格） | クリティカル | 接点が正しく定格 |
| CHARGE-CONTACT-002 | ステーションは4つの接点ピンを持つ必要がある: +48V、GND、CAN_H、CAN_L（電力 + 通信） | クリティカル | 4ピンが存在し機能的 |
| CHARGE-CONTACT-003 | 接点は車両接点と自動位置合わせする必要がある（X-Yで±50mm許容差） | クリティカル | 自動位置合わせが機能的 |
| CHARGE-CONTACT-004 | 接点は劣化なしで10,000回のメイティングサイクルに耐える必要がある | 高 | 耐久テスト合格 |
| CHARGE-CONTACT-005 | 接点はIP65定格である必要がある（防塵、水流耐性） | クリティカル | IP65認証取得 |
| CHARGE-CONTACT-006 | メイティング時の接触抵抗は<10mΩである必要がある | 高 | 抵抗を測定 |

---

## 3. 車両充電ポート要件

### 3.1 車両側接点

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-VPORT-001 | 車両は後部取り付け充電ポートを持つ必要がある（中央、高さ500mm） | クリティカル | ポート位置を検証 |
| CHARGE-VPORT-002 | 充電ポートは凹型接点を使用する必要がある（非充電時は雨から保護） | クリティカル | 接点が保護されている |
| CHARGE-VPORT-003 | 車両接点はスプリング式である必要がある（セルフクリーニング、圧力維持） | 高 | 接点がセルフクリーニング |
| CHARGE-VPORT-004 | 充電ポートはLEDインジケーターを持つ必要がある: オフ=切断、緑=充電中、青=完全充電 | 高 | LEDインジケーターが機能的 |
| CHARGE-VPORT-005 | ポートは精密ドッキング用のArUcoマーカーを含む必要がある（100mm × 100mm、ID 50） | クリティカル | ArUcoマーカー検出 |

### 3.2 車両充電ロジック

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-VLOGIC-001 | 車両はステーションとのCANバスハンドシェイクを介して充電接続を検出する必要がある | クリティカル | 接続検出が機能的 |
| CHARGE-VLOGIC-002 | 車両はバッテリーステータスをステーションに通信する必要がある: SOC、電圧、温度、健全性 | クリティカル | バッテリーテレメトリー送信 |
| CHARGE-VLOGIC-003 | 車両は成功したハンドシェイク後にのみ充電電流を受け入れる必要がある（偶発的充電防止） | クリティカル | ハンドシェイクが必要 |
| CHARGE-VLOGIC-004 | 車両は充電安全性を監視する必要がある: 過電流、過電圧、過温度 | クリティカル | 安全監視がアクティブ |
| CHARGE-VLOGIC-005 | 車両は故障検出時に充電を切断する必要がある（緊急切断リレー） | クリティカル | 緊急切断が機能的 |

---

## 4. 自動充電ワークフロー要件

### 4.1 充電ステーションへの自動復帰

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-AUTO-001 | 車両はバッテリーが<30% SOCの時に自動的に充電ステーションにナビゲートする必要がある | クリティカル | 30%で自動復帰トリガー |
| CHARGE-AUTO-002 | 車両は出発前に充電ベイの利用可能性を確認する必要がある（占有ベイを回避） | 高 | ベイ利用可能性確認が機能的 |
| CHARGE-AUTO-003 | すべてのベイが占有されている場合、車両はキューで待機する必要がある（近くに駐車、ベイステータス監視） | 高 | キュー管理が機能的 |
| CHARGE-AUTO-004 | 最初の試行が失敗した場合、車両はドッキングを再試行する必要がある（最大3回再試行） | 高 | 再試行ロジックが機能的 |
| CHARGE-AUTO-005 | 3回のドッキング失敗後、車両は充電ミッションを中止しオペレーターに警告する必要がある | クリティカル | 中止と警告が機能的 |

### 4.2 充電のための精密ドッキング

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-DOCK-001 | 車両は最終ドッキング位置合わせのために充電ポート上のArUcoマーカーを使用する必要がある | クリティカル | ArUcoベースドッキングが機能的 |
| CHARGE-DOCK-002 | ドッキング精度はX-Yで±20mm、ヨーで±5°である必要がある（接点は±50mm内で自動位置合わせ） | クリティカル | ドッキング精度を測定 |
| CHARGE-DOCK-003 | 車両は充電ベイに後退する必要がある（後部充電ポートがステーション接点と位置合わせ） | クリティカル | 後退ドッキングが機能的 |
| CHARGE-DOCK-004 | ドッキング後、車両は移動を停止しパーキングブレーキをかける必要がある | クリティカル | パーキングブレーキがかかる |
| CHARGE-DOCK-005 | 車両は充電開始前にCANハンドシェイクを介して接点メイティングを検証する必要がある | クリティカル | ハンドシェイク検証が機能的 |

### 4.3 充電プロセス

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-PROC-001 | 充電はCC-CVプロファイルを使用する必要がある: 54Vまで定電流（20A）、その後定電圧 | クリティカル | CC-CVプロファイル実装 |
| CHARGE-PROC-002 | 電流が1A以下に低下したら充電を終了する必要がある（完全充電インジケーター） | クリティカル | 充電終了が正しい |
| CHARGE-PROC-003 | BMSは充電中にセルバランシングを実行する必要がある（セル電圧を10mV以内に均等化） | 高 | セルバランシングが機能的 |
| CHARGE-PROC-004 | 充電時間は20% → 80% SOCで≤2時間である必要がある（通常の日次再充電） | 高 | 充電時間を測定 |
| CHARGE-PROC-005 | 車両はSOC ≥80%またはミッション優先度が早期出発を要求するまで接続されたままである必要がある | 高 | 充電完了ロジックが正しい |
| CHARGE-PROC-006 | 車両は60秒ごとにTVMサーバーに充電進捗を送信する必要がある | 高 | 進捗更新が送信される |

### 4.4 充電後の出発

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-DEPART-001 | 充電完了時、車両は自動的に充電器から切断する必要がある（リレー解放） | クリティカル | 自動切断が機能的 |
| CHARGE-DEPART-002 | 車両は充電ベイから出る必要がある（前進、次の車両のためにベイをクリア） | クリティカル | ベイ出発が機能的 |
| CHARGE-DEPART-003 | 車両はTVMサーバーに充電完了と利用可能性を通知する必要がある | 高 | 完了通知が送信される |
| CHARGE-DEPART-004 | 出発直後、車両は新しいミッション割り当てを受け入れる必要がある | 高 | ミッション割り当てが受け入れられる |

---

## 5. 充電中のバッテリー管理

### 5.1 充電安全性

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-SAFE-001 | BMSは充電中にセル電圧を監視する必要がある（セルあたり最大4.2V、13S = 54.6Vパック） | クリティカル | 電圧監視がアクティブ |
| CHARGE-SAFE-002 | BMSは充電中にセル温度を監視する必要がある（0°C ～ 45°C許可） | クリティカル | 温度監視がアクティブ |
| CHARGE-SAFE-003 | いずれかのセルが>4.25Vの場合、BMSは充電を停止する必要がある（過電圧保護） | クリティカル | 過電圧保護が機能的 |
| CHARGE-SAFE-004 | いずれかのセルが>50°Cの場合、BMSは充電を停止する必要がある（過温度保護） | クリティカル | 過温度保護が機能的 |
| CHARGE-SAFE-005 | 充電電流が>25Aの場合、BMSは充電を停止する必要がある（過電流保護、定格の125%） | クリティカル | 過電流保護が機能的 |
| CHARGE-SAFE-006 | ステーションは地絡検出を持つ必要がある（>30mA漏れ電流でトリップ） | クリティカル | GFCIが機能的 |

### 5.2 バッテリー健全性監視

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-HEALTH-001 | BMSはバッテリーサイクル数を追跡する必要がある（各20% → 80%充電サイクルで増加） | 高 | サイクル数が追跡される |
| CHARGE-HEALTH-002 | BMSは容量減衰に基づいてバッテリー健全性状態（SOH）を推定する必要がある | 中 | SOH推定が機能的 |
| CHARGE-HEALTH-003 | BMSは充電履歴を記録する必要がある: タイムスタンプ、SOC開始/終了、期間、供給エネルギー | 中 | 充電履歴が記録される |
| CHARGE-HEALTH-004 | バッテリーSOHが<80%の時、システムはオペレーターに警告する必要がある（交換推奨） | 中 | SOH警告が機能的 |

---

## 6. フリート充電調整要件

### 6.1 充電キュー管理

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-QUEUE-001 | TVMサーバーは充電キューを維持する必要がある（充電待ちの車両リスト） | 高 | キュー管理が機能的 |
| CHARGE-QUEUE-002 | キューは緊急度で車両を優先する必要がある: クリティカル（<15% SOC）、高（<30% SOC）、通常 | クリティカル | 優先度キューが機能的 |
| CHARGE-QUEUE-003 | ベイが利用可能になったらTVMサーバーはキュー内の次の車両に通知する必要がある | 高 | キュー通知が送信される |
| CHARGE-QUEUE-004 | システムは充電競合を防ぐ必要がある（2台の車両が同じベイに割り当てられる） | クリティカル | 競合防止が機能的 |

### 6.2 充電スケジュール最適化

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-SCHED-001 | TVMサーバーはミッションスケジュールに基づいて車両バッテリー消耗を予測する必要がある | 中 | 消耗予測が機能的 |
| CHARGE-SCHED-002 | システムは低需要期間中に積極的に充電をスケジュールする必要がある（例: 昼休み12-13:00） | 中 | 積極的スケジューリングが機能的 |
| CHARGE-SCHED-003 | システムはオペレーターが車両を手動で充電に送ることを許可する必要がある（自動スケジュールをオーバーライド） | 高 | 手動充電コマンドが機能的 |
| CHARGE-SCHED-004 | システムはピーク需要中の車両充電を防ぐ必要がある（ポリシーが設定されている場合） | 低 | ピーク需要回避が機能的 |

---

## 7. 充電ステーション監視と診断

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-MON-001 | 充電ステーションはTVMサーバーにステータスを公開する必要がある: ベイ占有、電力出力、故障 | 高 | ステータスがTVMに公開される |
| CHARGE-MON-002 | ステーションは充電イベントを記録する必要がある: 車両接続、充電開始、充電完了、エラー | 中 | イベントログが機能的 |
| CHARGE-MON-003 | ステーションは充電セッションごとのエネルギー消費を測定およびレポートする必要がある（kWh） | 中 | エネルギーメーターが機能的 |
| CHARGE-MON-004 | ステーションはLEDパネルにローカルステータスを表示する必要がある: ベイ1ステータス、ベイ2ステータス、利用可能電力 | 低 | LEDステータス表示が機能的 |
| CHARGE-MON-005 | ステーションはイーサネット接続を介したリモート診断をサポートする必要がある | 低 | リモート診断がアクセス可能 |

---

## 8. 緊急および故障処理

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-FAULT-001 | 接点短絡時、ステーションは即座に電力を切断する必要がある（100ms以内） | クリティカル | 短絡保護が機能的 |
| CHARGE-FAULT-002 | 充電故障時、ステーションはオペレーターに警告する必要がある: 過電流、過電圧、タイムアウト | クリティカル | 故障警告が送信される |
| CHARGE-FAULT-003 | 緊急停止ボタン押下時、車両は充電から切断する必要がある | クリティカル | 緊急停止が充電を切断 |
| CHARGE-FAULT-004 | ステーションは手動緊急停止ボタンを持つ必要がある（赤いマッシュルームヘッド、すべての電力を切断） | クリティカル | 手動緊急停止が機能的 |
| CHARGE-FAULT-005 | システムはすべての故障を記録する必要がある: タイムスタンプ、エラーコード、車両ID、ベイ番号 | 高 | 故障ログが機能的 |

---

## 9. 充電ステーション設置要件

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-INSTALL-001 | ステーションはコンクリートパッドに設置される必要がある（水平、耐荷重） | クリティカル | コンクリートパッドが設置される |
| CHARGE-INSTALL-002 | ステーションはパッドに固定される必要がある（500N水平力に耐える、転倒防止） | 高 | 固定がテストされる |
| CHARGE-INSTALL-003 | 電気設置は地域の電気規格に準拠する必要がある（例: NEC、IEC） | クリティカル | 規格準拠が検証される |
| CHARGE-INSTALL-004 | ステーションはアクセス可能な場所に設置される必要がある（車両アプローチパスがクリア） | 高 | 場所アクセス性が検証される |
| CHARGE-INSTALL-005 | ステーションは適切な排水を持つ必要がある（接点周りの水たまりを防ぐ） | 中 | 排水が機能的 |

---

## 10. 充電性能要件

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-PERF-001 | 充電効率は≥90%である必要がある（AC入力からバッテリーまで） | 高 | 効率が測定される |
| CHARGE-PERF-002 | 20% → 80% SOCの充電時間は≤2時間である必要がある（960Wh容量、20A @ 48V） | 高 | 充電時間が検証される |
| CHARGE-PERF-003 | ドッキング成功率は≥95%である必要がある（初回試行） | 高 | ドッキング成功率が測定される |
| CHARGE-PERF-004 | 接点メイティング信頼性は≥99%である必要がある（成功した電気接続） | クリティカル | メイティング信頼性が検証される |
| CHARGE-PERF-005 | ステーション稼働率は≥99%である必要がある（定期メンテナンスを除く） | 中 | 稼働率が測定される |

---

## 11. 将来の拡張要件

| ID | 要件 | 優先度 | 受入基準 |
|----|-------------|----------|---------------------|
| CHARGE-FUTURE-001 | ステーション設計は4ベイへの拡張をサポートする必要がある（モジュラーベイ追加） | 低 | 拡張能力が検証される |
| CHARGE-FUTURE-002 | ステーションは将来のソーラーパネル統合のためのスペースを確保する必要がある（屋根取り付け） | 低 | ソーラーパネル取り付けポイントが存在 |
| CHARGE-FUTURE-003 | ステーションは将来の急速充電アップグレードをサポートする必要がある（20A → ベイあたり40A） | 低 | 電源がアップグレード可能 |

---

## 12. 要件サマリー

| カテゴリ | 数 | 優先度内訳 |
|----------|-------|-------------------|
| 充電ステーションハードウェア | 16 | クリティカル: 7、高: 6、中: 3 |
| 車両充電ポート | 10 | クリティカル: 7、高: 3 |
| 自動充電ワークフロー | 19 | クリティカル: 13、高: 6 |
| 充電中のバッテリー管理 | 10 | クリティカル: 7、高: 2、中: 1 |
| フリート充電調整 | 7 | クリティカル: 2、高: 3、中: 2 |
| 充電ステーション監視 | 5 | 高: 1、中: 3、低: 1 |
| 緊急および故障処理 | 5 | クリティカル: 4、高: 1 |
| 設置要件 | 5 | クリティカル: 2、高: 2、中: 1 |
| 性能要件 | 5 | クリティカル: 1、高: 3、中: 1 |
| 将来の拡張 | 3 | 低: 3 |
| **合計** | **85** | **クリティカル: 43、高: 27、中: 12、低: 3** |

---

## 13. 充電ステーションシステム図

```
┌─────────────────────────────────────────────────────────┐
│            充電ステーション（2ベイ）                      │
│                                                         │
│  200V 3相AC入力                                          │
│         │                                               │
│         ▼                                               │
│  ┌──────────────┐                                       │
│  │  AC-DCコンバ │  (200V AC → 48V DC、4kW合計)          │
│  │  + 負荷分散  │                                       │
│  └──────┬───────┘                                       │
│         │                                               │
│    ┌────┴────┐                                          │
│    │         │                                          │
│    ▼         ▼                                          │
│ ┌─────┐   ┌─────┐                                       │
│ │ベイ1│   │ベイ2│  (48V @ 20A各、ベイあたり2kW)         │
│ │     │   │     │                                       │
│ │ 🔌  │   │ 🔌  │  (ポゴピン接点: +48V、GND、          │
│ │     │   │     │   CAN_H、CAN_L)                       │
│ └─────┘   └─────┘                                       │
│   │         │                                           │
│   │ ArUco   │ ArUco                                     │
│   │マーカー │マーカー                                    │
│   │         │                                           │
└───┼─────────┼───────────────────────────────────────────┘
    │         │
    ▼         ▼
 車両      車両
(後部      (後部
 ポート)    ポート)
```

---

## 14. トレーサビリティマトリクス

| 充電要件カテゴリ | 関連システムコンポーネント |
|------------------------------|---------------------------|
| ステーションハードウェア | AC-DCコンバーター、電力分配、接点アセンブリ |
| 車両ポート | BMS、充電リレー、CANバス、ArUcoマーカー |
| 自動ワークフロー | ナビゲーションコントローラー、ドッキングコントローラー、フリート管理サーバー |
| バッテリー管理 | BMS、温度センサー、電圧センサー、電流センサー |

---

## 15. 改訂履歴

| バージョン | 日付 | 作成者 | 変更内容 |
|---------|------|--------|---------|
| 1.0 | 2025-12-16 | マルチチーム | 初版充電インフラストラクチャ要件（85要件） |

---

**ドキュメント終了**
