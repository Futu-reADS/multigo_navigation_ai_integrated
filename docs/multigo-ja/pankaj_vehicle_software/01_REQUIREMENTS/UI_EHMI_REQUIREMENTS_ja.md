# UIとeHMI要件

**文書ID:** REQ-UI-001
**バージョン:** 1.0
**日付:** 2025年12月15日
**ステータス:** ドラフト

---

## 1. はじめに

この文書は**ユーザーインターフェース（タッチスクリーン）**と**外部ヒューマンマシンインターフェース（eHMI）**サブシステムの要件を規定します。

---

## 2. タッチスクリーンUI要件

### 2.1 ハードウェア（UI-HW）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| UI-HW-001 | システムは7-10インチのタッチスクリーンを持つこと | Critical | ハードウェアBOM |
| UI-HW-002 | タッチスクリーンは日光下で視認可能であること（≥400 nits） | High | フィールド試験 |
| UI-HW-003 | タッチスクリーンはIP65以上のフロントパネルを持つこと | Critical | IP試験 |
| UI-HW-004 | タッチスクリーンは静電容量式マルチタッチをサポートすること | High | ハードウェア試験 |

**合計: 4**

### 2.2 ソフトウェアスタック（UI-SW）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| UI-SW-001 | UIはReact 18 + Next.js 14で構築すること | Critical | コード検査 |
| UI-SW-002 | UIは型安全性のためTypeScriptを使用すること | High | コード検査 |
| UI-SW-003 | UIはrosbridge経由でROS 2と通信すること | Critical | 統合試験 |
| UI-SW-004 | UIはChromium/Electronキオスクモードで実行すること | High | デプロイメント試験 |

**合計: 4**

### 2.3 ユーザーフロー（UI-FLOW）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| UI-FLOW-001 | UIはロボットステータスを表示すること（バッテリー、位置、ミッション） | Critical | UI試験 |
| UI-FLOW-002 | UIはウェイポイントリストから目的地選択を許可すること | Critical | UI試験 |
| UI-FLOW-003 | UIはミッション進捗を表示すること（ETA、距離） | High | UI試験 |
| UI-FLOW-004 | UIは緊急停止ボタンを提供すること | Critical | UI試験 |
| UI-FLOW-005 | UIは診断とエラーメッセージを表示すること | High | UI試験 |
| UI-FLOW-006 | UIは手動ローカライゼーション初期化をサポートすること | High | UI試験 |

**合計: 6**

### 2.4 アクセシビリティ（UI-ACCESS）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| UI-ACCESS-001 | UIは大きなタッチターゲットを持つこと（≥44×44ピクセル） | High | エルゴノミック試験 |
| UI-ACCESS-002 | UIは複数言語をサポートすること（EN、JP、ZH） | High | ローカライゼーション試験 |
| UI-ACCESS-003 | UIは低視力者向けの高コントラストモードを持つこと | Medium | アクセシビリティ試験 |
| UI-ACCESS-004 | UIはアクションに対する音声フィードバックを提供すること | Medium | オーディオ試験 |

**合計: 4**

---

## 3. eHMI要件

### 3.1 ハードウェアコンポーネント（EHMI-HW）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| EHMI-HW-001 | システムはESP32-S3マイクロコントローラーを持つこと | Critical | ハードウェアBOM |
| EHMI-HW-002 | システムはWS2812B LEDストリップを持つこと（≥60 LED） | Critical | ハードウェアBOM |
| EHMI-HW-003 | システムはHUB75 LEDマトリックスを持つこと（64×32ピクセル） | High | ハードウェアBOM |
| EHMI-HW-004 | システムはI2Sオーディオアンプ + スピーカーを持つこと | High | ハードウェアBOM |
| EHMI-HW-005 | eHMIはシリアル経由で通信すること（115200ボー） | Critical | インターフェース試験 |

**合計: 5**

### 3.2 eHMI状態（EHMI-STATE）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| EHMI-STATE-001 | eHMIは状態0-20を実装すること（標準ロボット状態） | Critical | 状態試験 |
| EHMI-STATE-002 | eHMIは状態21-28を実装すること（車椅子専用） | Critical | 状態試験 |
| EHMI-STATE-003 | 状態21: 車椅子に接近中 | High | 統合試験 |
| EHMI-STATE-004 | 状態22: ドッキング進行中 | High | 統合試験 |
| EHMI-STATE-005 | 状態23: ドッキング完了 | High | 統合試験 |
| EHMI-STATE-006 | 状態24: 乗客乗車中 | High | 統合試験 |
| EHMI-STATE-007 | 状態25: 輸送進行中 | High | 統合試験 |
| EHMI-STATE-008 | 状態26: 目的地到着 | High | 統合試験 |
| EHMI-STATE-009 | 状態27: 乗客下車 | High | 統合試験 |
| EHMI-STATE-010 | 状態28: ドッキング失敗 | High | 統合試験 |

**合計: 10**

### 3.3 LEDパターン（EHMI-LED）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| EHMI-LED-001 | LEDストリップは状態固有の色/パターンを表示すること | Critical | 視覚試験 |
| EHMI-LED-002 | LEDマトリックスはロボットの意図を示す矢印/アイコンを表示すること | High | 視覚試験 |
| EHMI-LED-003 | 緊急状態は赤色点滅パターンを使用すること | Critical | 安全試験 |
| EHMI-LED-004 | LED輝度は周囲光に基づいて調整すること | Medium | 統合試験 |

**合計: 4**

### 3.4 オーディオフィードバック（EHMI-AUDIO）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| EHMI-AUDIO-001 | システムは主要イベントのオーディオアナウンスを再生すること | High | オーディオ試験 |
| EHMI-AUDIO-002 | オーディオは複数言語をサポートすること（EN、JP、ZH） | High | ローカライゼーション試験 |
| EHMI-AUDIO-003 | オーディオ音量は調整可能であること（0-10） | High | 設定試験 |
| EHMI-AUDIO-004 | 緊急状態はサイレン音を再生すること | Critical | 安全試験 |

**合計: 4**

---

## 4. 要件サマリー

| カテゴリー | 合計 | Critical | High | Medium | Low |
|----------|-------|----------|------|--------|-----|
| **タッチスクリーンUI** | **18** | 7 | 10 | 1 | 0 |
| **eHMIハードウェア** | **5** | 4 | 1 | 0 | 0 |
| **eHMI状態** | **10** | 2 | 8 | 0 | 0 |
| **eHMI LED** | **4** | 2 | 1 | 1 | 0 |
| **eHMIオーディオ** | **4** | 1 | 3 | 0 | 0 |
| **合計** | **41** | **16 (39%)** | **23 (56%)** | **2 (5%)** | **0** |

---

## 5. 受入基準

### MVP UI/eHMI
- ✅ ミッションステータス付き基本タッチスクリーン
- ✅ 基本状態付きLEDストリップ
- ✅ 緊急停止ボタン（物理 + UI）

### プロダクション UI/eHMI
- ✅ すべてのMVP + すべての高優先度
- ✅ アイコン付き完全LEDマトリックス
- ✅ オーディオアナウンス
- ✅ 多言語サポート
- ✅ すべての車椅子状態21-28

---

**文書ステータス:** ドラフト
**必要な承認:** UI/UXリード、eHMIエンジニア、システムアーキテクト
