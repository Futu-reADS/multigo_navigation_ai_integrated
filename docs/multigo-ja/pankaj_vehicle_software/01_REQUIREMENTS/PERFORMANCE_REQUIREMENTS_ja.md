# パフォーマンス要件

**文書ID:** REQ-PERF-001
**バージョン:** 1.0
**日付:** 2025年12月15日
**ステータス:** ドラフト
**分類:** 社内

---

## 文書管理

| バージョン | 日付 | 著者 | 変更内容 |
|---------|------|--------|---------|
| 1.0 | 2025年12月15日 | システムアーキテクト | 初期システムレベルパフォーマンス要件 |

---

## 1. はじめに

### 1.1 目的

この文書は、計算パフォーマンス、ミッションパフォーマンス、信頼性、および可用性目標を含む**すべてのシステムレベルパフォーマンス要件**を統合します。

### 1.2 スコープ

- **計算パフォーマンス** - CPU、メモリ、ネットワーク、レイテンシ
- **ミッションパフォーマンス** - 速度、範囲、バッテリー寿命、成功率
- **信頼性** - MTBF、エラー率、復旧時間
- **可用性** - アップタイム、メンテナンスウィンドウ

---

## 2. 計算パフォーマンス

### 2.1 CPU パフォーマンス（PERF-COMP-CPU）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-COMP-CPU-001 | システムは通常動作中にCPU使用率<70%であること | Critical | htop監視 |
| PERF-COMP-CPU-002 | ローカライゼーションはCPU使用率<20%であること | High | ros2 top |
| PERF-COMP-CPU-003 | 経路計画はCPU使用率<15%であること | High | ros2 top |
| PERF-COMP-CPU-004 | パーセプションはCPU使用率<35%であること | High | ros2 top |
| PERF-COMP-CPU-005 | システムはピーク時のために≥20% CPUヘッドルームを確保すること | High | 負荷試験 |

**合計: 5**

### 2.2 メモリパフォーマンス（PERF-COMP-MEM）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-COMP-MEM-001 | システムは通常動作中にRAM使用<20 GBであること | Critical | free -h |
| PERF-COMP-MEM-002 | システムはメモリリークがないこと | Critical | valgrind 24時間試験 |
| PERF-COMP-MEM-003 | システムは≥8 GB RAMの空きを確保すること | High | free -h |

**合計: 3**

### 2.3 ネットワークパフォーマンス（PERF-COMP-NET）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-COMP-NET-001 | DDSトラフィックは平均<50 MB/sであること | High | iftop監視 |
| PERF-COMP-NET-002 | WiFiレイテンシは基地局まで<50msであること | High | ping試験 |
| PERF-COMP-NET-003 | システムは50m範囲で接続を維持すること | High | フィールド試験 |

**合計: 3**

### 2.4 処理レイテンシ（PERF-COMP-LAT）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-COMP-LAT-001 | エンドツーエンドレイテンシ（センサー → cmd_vel）は<200msであること | Critical | レイテンシ試験 |
| PERF-COMP-LAT-002 | ローカライゼーションレイテンシは<50msであること | Critical | タイムスタンプ分析 |
| PERF-COMP-LAT-003 | 障害物検出レイテンシは<100msであること | Critical | レイテンシ試験 |
| PERF-COMP-LAT-004 | 経路計画レイテンシは<100msであること | High | レイテンシ試験 |

**合計: 4**

---

## 3. ミッションパフォーマンス

### 3.1 速度と加速度（PERF-MISSION-SPEED）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-MISSION-SPEED-001 | 最高速度は1.5 m/s（乗客なし）であること | Critical | 速度試験 |
| PERF-MISSION-SPEED-002 | 最高速度は1.0 m/s（乗客あり）であること | Critical | 速度試験 |
| PERF-MISSION-SPEED-003 | 平均ミッション速度は0.8 m/sであること | High | フィールド試験 |
| PERF-MISSION-SPEED-004 | 最大加速度は0.5 m/s²（乗客あり）であること | Critical | 加速試験 |
| PERF-MISSION-SPEED-005 | システムは最高速度に<3秒で到達すること | Medium | 加速試験 |

**合計: 5**

### 3.2 範囲とバッテリー寿命（PERF-MISSION-RANGE）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-MISSION-RANGE-001 | システムはミッションあたり500m-1km動作すること | Critical | フィールド試験 |
| PERF-MISSION-RANGE-002 | バッテリーは乗客輸送で4時間以上持続すること | Critical | 耐久試験 |
| PERF-MISSION-RANGE-003 | システムは充電あたり≥5ミッションを完了すること | High | 耐久試験 |
| PERF-MISSION-RANGE-004 | システムはバッテリー30%で帰還を開始すること | Critical | 統合試験 |

**合計: 4**

### 3.3 ナビゲーション精度（PERF-MISSION-NAV）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-MISSION-NAV-001 | 位置精度は500m走行で±10cmであること | Critical | フィールド試験（50ミッション） |
| PERF-MISSION-NAV-002 | 位置精度は1km走行で±20cmであること | High | フィールド試験（20ミッション） |
| PERF-MISSION-NAV-003 | ウェイポイント精度は±30cmであること | High | ウェイポイント試験 |
| PERF-MISSION-NAV-004 | 向き精度は±2°であること | High | フィールド試験 |

**合計: 4**

### 3.4 ドッキングパフォーマンス（PERF-MISSION-DOCK）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-MISSION-DOCK-001 | ドッキング精度は屋外で±2-5mmであること | Critical | 100回ドッキング試験 |
| PERF-MISSION-DOCK-002 | ドッキング成功率は屋外で>95%であること | Critical | 1000回試行 |
| PERF-MISSION-DOCK-003 | ドッキング時間は<120秒であること | High | パフォーマンス試験 |
| PERF-MISSION-DOCK-004 | 夜間ドッキング成功率は>90%であること | High | 50回夜間試行 |

**合計: 4**

### 3.5 ミッション成功率（PERF-MISSION-SUCCESS）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-MISSION-SUCCESS-001 | 全体のミッション成功率は>95%であること | Critical | 1000ミッション |
| PERF-MISSION-SUCCESS-002 | 復旧成功率は>90%であること | High | 100回のスタックシナリオ |
| PERF-MISSION-SUCCESS-003 | 誤緊急停止率は<1%であること | High | 1000時間動作 |

**合計: 3**

---

## 4. 信頼性

### 4.1 平均故障間隔（PERF-REL-MTBF）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-REL-MTBF-001 | システムMTBFは>1000時間であること | High | 長期試験 |
| PERF-REL-MTBF-002 | ローカライゼーション失敗率は<0.1%であること | Critical | 統計分析 |
| PERF-REL-MTBF-003 | センサー障害検出率は>99%であること | Critical | 故障注入試験 |

**合計: 3**

### 4.2 エラー復旧（PERF-REL-RECOVERY）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-REL-RECOVERY-001 | システムはスタック状態から2分以内に復旧すること | High | スタック試験 |
| PERF-REL-RECOVERY-002 | システムは復旧後にミッションを再開すること | High | 統合試験 |
| PERF-REL-RECOVERY-003 | システムは完全なコンテキストと共にすべてのエラーをログすること | Critical | ログ検査 |

**合計: 3**

---

## 5. 可用性

### 5.1 システムアップタイム（PERF-AVAIL-UPTIME）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-AVAIL-UPTIME-001 | システムアップタイムは運用時間中>99%であること | High | アップタイム監視 |
| PERF-AVAIL-UPTIME-002 | システムは12時間の連続動作をサポートすること | High | 耐久試験 |
| PERF-AVAIL-UPTIME-003 | システムはグレースフルシャットダウン/再起動を処理すること | Critical | 電源サイクル試験 |

**合計: 3**

### 5.2 メンテナンス（PERF-AVAIL-MAINT）

| 要件ID | 要件 | 優先度 | 検証方法 |
|----------------|-------------|----------|------------|
| PERF-AVAIL-MAINT-001 | ソフトウェア更新は<30分で完了すること | High | 更新試験 |
| PERF-AVAIL-MAINT-002 | バッテリー交換は<10分で完了すること | Medium | 手順試験 |
| PERF-AVAIL-MAINT-003 | システム診断はUI経由でアクセス可能であること | High | UI試験 |

**合計: 3**

---

## 6. 要件サマリー

| カテゴリー | 合計 | Critical | High | Medium | Low |
|----------|-------|----------|------|--------|-----|
| **計算** | **15** | 7 | 8 | 0 | 0 |
| **ミッション** | **20** | 9 | 10 | 1 | 0 |
| **信頼性** | **6** | 3 | 3 | 0 | 0 |
| **可用性** | **6** | 1 | 4 | 1 | 0 |
| **合計** | **47** | **20 (43%)** | **25 (53%)** | **2 (4%)** | **0** |

---

## 7. 受入基準

### MVP パフォーマンス
- ✅ <70% CPU、<20GB RAM
- ✅ 500m走行で±20cm精度
- ✅ >90%ミッション成功率
- ✅ >90%ドッキング成功率
- ✅ 4時間以上のバッテリー寿命

### プロダクション パフォーマンス
- ✅ すべてのMVP + すべての高優先度
- ✅ 500m走行で±10cm精度
- ✅ >95%ミッション成功
- ✅ >95%ドッキング成功
- ✅ >99%アップタイム
- ✅ 1000時間MTBF

---

**文書ステータス:** ドラフト
**必要な承認:** システムアーキテクト、ナビゲーションリード、安全エンジニア
